//Программа «Region» предназначена для хранения, редактирования и просмотра информации о странах и их формах государственного устройства.
//Она моделирует простейшую систему учёта государств, позволяя пользователю вводить данные о стране, континенте и политической системе — президентской, парламентской или смешанной.

//Данные сохраняются в бинарный файл LAND.DAT, который служит внутренней базой данных программы.
//Программа работает в интерактивном режиме с удобным текстовым меню.

Program Region;

Uses
  CRT;  { Подключение модуля для управления экраном и клавиатурой }

{------------------------------------------------------------}
{ Типы данных                                                }
{------------------------------------------------------------}
type
  { Перечислимый тип — форма государственного устройства }
  Gos_Us = (Prez, Parl, Smes);

  { Основная запись, описывающая страну }
  Reg = record
    n: integer;              { Порядковый номер записи }
    Country: String[30];     { Название страны }
    Land: String[30];        { Название континента }
    case ustr: Gos_Us of
      Prez: (FIO_Prez: String[50];   { ФИО президента }
             Sr_Doh: Real);          { Средний доход населения }
      Parl: (FIO_Prem: String[50];   { ФИО премьер-министра }
             Nas: LongInt);          { Население }
      Smes: (Kol: Integer;           { Количество партий }
             Chis: Integer);         { Число спидоносных (по условию задачи) }
  end;

{------------------------------------------------------------}
{ Глобальные переменные                                      }
{------------------------------------------------------------}
var
  land: file of Reg;  { Файл для хранения записей о странах }
  s, us, abc: String; { Переменные для ввода строк }
  x: Reg;             { Переменная для временного хранения одной записи }
  k, v: integer;      { Счётчики и коды ошибок при преобразовании чисел }
  ch: char;           { Переменная для клавиши в меню }

{------------------------------------------------------------}
{ Основная программа                                         }
{------------------------------------------------------------}
begin
  Assign(land, 'LAND.DAT');  { Привязка файла к имени LAND.DAT }
  ClrScr;
  k := 0;

  repeat
    ClrScr;
    Writeln('==========================================');
    Writeln('          СИСТЕМА УЧЁТА СТРАН');
    Writeln('==========================================');
    Writeln('1 - Ввод и редактирование записей');
    Writeln('2 - Просмотр записей');
    Writeln('0 - Выход');
    Writeln('------------------------------------------');
    Write('Ваш выбор: ');
    Readln(s);

    {------------------------------------------------------------}
    { Режим 1: редактирование записей                            }
    {------------------------------------------------------------}
    if s = '1' then
    begin
      Rewrite(land);  { Создаёт новый файл (перезаписывает старый) }
      repeat
        ClrScr;
        k := k + 1;
        x.n := k;

        Writeln('------------------------------------------');
        Writeln('Ввод данных о стране №', x.n);
        Writeln('------------------------------------------');
        Write('Введите название страны: ');
        Readln(x.country);

        Write('Введите название континента: ');
        Readln(x.land);

        {------------------ Ввод типа гос. устройства ------------------}
        repeat
          Writeln;
          Writeln('Введите тип государственного устройства:');
          Writeln('1 - президентская');
          Writeln('2 - парламентская');
          Writeln('3 - смешанная');
          Write('Ваш выбор: ');
          Readln(us);
          if us = '1' then
          begin
            x.ustr := Prez;
            Write('Введите Ф.И.О. президента: ');
            Readln(x.fio_prez);
            repeat
              Write('Введите средний доход: ');
              Readln(abc);
              Val(abc, x.sr_doh, v);
              if v <> 0 then Writeln('Ошибка! Введите число.');
            until v = 0;
          end
          else if us = '2' then
          begin
            x.ustr := Parl;
            Write('Введите Ф.И.О. премьера: ');
            Readln(x.fio_prem);
            repeat
              Write('Введите население: ');
              Readln(abc);
              Val(abc, x.nas, v);
              if v <> 0 then Writeln('Ошибка! Введите целое число.');
            until v = 0;
          end
          else if us = '3' then
          begin
            x.ustr := Smes;
            repeat
              Write('Введите количество партий: ');
              Readln(abc);
              Val(abc, x.kol, v);
              if v <> 0 then Writeln('Ошибка! Введите целое число.');
            until v = 0;
            repeat
              Write('Введите число спидоносных: ');
              Readln(abc);
              Val(abc, x.chis, v);
              if v <> 0 then Writeln('Ошибка! Введите целое число.');
            until v = 0;
          end
          else
          begin
            Writeln('Некорректный выбор! Введите 1, 2 или 3.');
            us := '';
          end;
        until (us = '1') or (us = '2') or (us = '3');

        { Запись данных в файл }
        Write(land, x);
        Writeln;
        Writeln('Запись успешно добавлена!');

        Writeln;
        Writeln('Нажмите [Enter] для добавления новой записи, [Esc] — для выхода.');
        ch := ReadKey;
      until ch = #27;  { ESC — выход из ввода }

      Close(land);
    end

    {------------------------------------------------------------}
    { Режим 2: просмотр записей                                  }
    {------------------------------------------------------------}
    else if s = '2' then
    begin
      {$I-}  { Отключаем автоошибки ввода-вывода }
      Reset(land);
      {$I+}
      if IOResult <> 0 then
        Writeln('Файл LAND.DAT не найден! Сначала добавьте записи.')
      else
      begin
        ClrScr;
        Writeln('------------------------------------------');
        Writeln('СПИСОК СТРАН:');
        Writeln('------------------------------------------');
        while not EOF(land) do
        begin
          Read(land, x);
          Writeln('Страна: ', x.Country);
          Writeln('Континент: ', x.Land);
          case x.ustr of
            Prez:
              begin
                Writeln('Тип: Президентская');
                Writeln('Президент: ', x.FIO_Prez);
                Writeln('Средний доход: ', x.Sr_Doh:0:2);
              end;
            Parl:
              begin
                Writeln('Тип: Парламентская');
                Writeln('Премьер: ', x.FIO_Prem);
                Writeln('Население: ', x.Nas);
              end;
            Smes:
              begin
                Writeln('Тип: Смешанная');
                Writeln('Количество партий: ', x.Kol);
                Writeln('Число спидоносных: ', x.Chis);
              end;
          end;
          Writeln('------------------------------------------');
        end;
        Close(land);
      end;

      Writeln;
      Writeln('Нажмите любую клавишу для возврата в меню...');
      ReadKey;
    end;

  until s = '0';  { 0 — выход из программы }

  ClrScr;
  Writeln('Работа программы завершена. До свидания!');
  Readln;
end.
